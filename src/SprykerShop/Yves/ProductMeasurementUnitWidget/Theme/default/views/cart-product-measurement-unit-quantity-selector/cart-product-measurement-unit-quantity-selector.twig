{% extends template('widget') %}

{% define data = {
    cartItem: _widget.itemTransfer,
    isBaseUnit: _widget.isBaseUnit ?? true,
    minQuantity: _widget.minQuantity,
    maxQuantity: _widget.maxQuantity,
    quantityInterval: _widget.quantityInterval,
} %}

{%- block hasSalesUnit -%}
    {{- _widget.itemTransfer.quantitySalesUnit.idProductMeasurementSalesUnit | default(false) -}}
{%- endblock -%}

{% block body %}
    {% set hasQuantitySalesUnit = data.cartItem.quantitySalesUnit is not empty %}

    {% include molecule('cart-quantity-input', 'CartPage') with {
        data: {
            cartItem: data.cartItem,
            readOnly: hasQuantitySalesUnit,
            minQuantity: data.minQuantity,
            maxQuantity: data.maxQuantity,
            quantityInterval: data.quantityInterval,
        },
    } only %}

    {% if hasQuantitySalesUnit %}
        {% set value = data.cartItem.quantitySalesUnit.value %}
        {% set precision = data.cartItem.quantitySalesUnit.precision %}
        {% set salesUnitName = data.cartItem.quantitySalesUnit.productMeasurementUnit.name | default('') %}

        <small class="text-secondary">
            [= {{ value / precision }} {{ salesUnitName | trans }}]
        </small>
    {% endif %}
{% endblock %}
